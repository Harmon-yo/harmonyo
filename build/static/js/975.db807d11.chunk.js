"use strict";(self.webpackChunkharmonyo=self.webpackChunkharmonyo||[]).push([[975],{9084:function(e,a,n){n.d(a,{Z:function(){return r}});n(2791);var t=n(4554),o=n(184);var r=function(e){return(0,o.jsx)(t.Z,{className:"card ".concat(e.className),sx:e.sx,id:e.id,onClick:e.onClick,children:e.children})}},4758:function(e,a,n){n.r(a),n.d(a,{default:function(){return Q}});var t=n(3433),o=n(9439),r=n(4056),s=n(4554),i=n(2791),l=n(7689),c=n(890),u=n(4721),d=n(9084),m=n(1687),h=n(3345),f=n(184);var p=function(e){var a=e.idProfessor,n=(0,i.useState)(""),t=(0,o.Z)(n,2),r=t[0],l=t[1],p=e.instrumento,x=null===p?"00,00":2===p.valor.length?null:"".concat(p.valor,",00");return(0,i.useEffect)((function(){var e;(e="/professores/".concat(a),m.Z.get(e,{headers:{Authorization:"Bearer ".concat(sessionStorage.TOKEN)}})).then((function(e){var a=e.data;l(a.nome)})).catch((function(){console.log("Erro ao obter professor")}))}),[]),(0,f.jsxs)(d.Z,{className:"card-usuario-info",children:[(0,f.jsxs)(s.Z,{className:"usuario-info",children:[(0,f.jsx)(h.Z,{id:a,nome:r,className:"usuario-info-avatar"}),(0,f.jsxs)(s.Z,{className:"duracao-container",children:[(0,f.jsx)(c.Z,{children:"Dura\xe7\xe3o"}),(0,f.jsx)(c.Z,{children:"1 Hora"})]})]}),(0,f.jsx)(c.Z,{className:"nome-usuario",children:r}),(0,f.jsxs)(s.Z,{className:"pedido-info-container",children:[(0,f.jsxs)(s.Z,{className:"item-pedido",children:[null===p?null:(0,f.jsx)(c.Z,{className:"item-nome",children:p.nome}),null===p?null:(0,f.jsxs)(c.Z,{className:"item-valor",children:["R$ ",x]})]}),(0,f.jsx)(u.Z,{className:"divider"}),(0,f.jsxs)(s.Z,{className:"item-pedido",children:[(0,f.jsx)(c.Z,{className:"item-nome",children:"Total"}),(0,f.jsxs)(c.Z,{className:"item-valor",children:["R$ ",x]})]})]})]})},x=n(242),Z=n(4512),g=n(5825),j=n(6151),v=n(3239),S=n(4750),N=n(1652),D=n(5185),E=n(8034),b=n(7892),w=n.n(b),C=(n(3918),n(4253)),y=n(3320);w().extend(C),w().extend(y);var H=function(e){var a=e.handleClicks,n=a.handleClickDia,t=a.handleClickHorario,o=e.diaEHoraEscolhidosState,r=o.diaEHoraEscolhidos,i=o.setDiaEHoraEscolhidos,l=e.errorHorarioState.setErroHorario;return e.diasIndisponiveis,(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(s.Z,{className:"item-pedido",children:[(0,f.jsx)(c.Z,{className:"item-valor",children:"Selecione um dia:"}),(0,f.jsx)(N._,{dateAdapter:S.y,sx:{height:"10% !important"},adapterLocale:"pt-br",children:(0,f.jsx)(D.M,{minDate:w()(new Date),maxDate:w()((new Date).setMonth((new Date).getMonth()+1)),onChange:function(e){n(e)},value:r,slotProps:{textField:{size:"small"}},dayOfWeekFormatter:function(e){return"".concat(function(e){switch(e){case"2\xaa":return"Seg";case"3\xaa":return"Ter";case"4\xaa":return"Qua";case"5\xaa":return"Qui";case"6\xaa":return"Sex";case"S\xe1":return"Sab";case"Do":return"Dom";default:return e}}(e))}})})]}),(0,f.jsxs)(s.Z,{className:"item-pedido",children:[(0,f.jsx)(c.Z,{className:"item-valor",children:"Selecione um hor\xe1rio:"}),(0,f.jsx)(N._,{dateAdapter:S.y,adapterLocale:"pt-br",children:(0,f.jsx)(E.j,{minTime:w()().hour(8).minute(0).second(0),maxTime:w()().hour(22).minute(0).second(0),slotProps:{textField:{size:"small"}},onChange:function(e){t(e)},value:r,ampm:!1,skipDisabled:!0,disablePast:!1,onError:function(){i(e.obterDataValida(r)),l(!0)},shouldDisableTime:function(e){return r.date()===w()().date()&&r.month()===w()().month()&&e.hour()<w()().hour()}})})]})]})},k=n(8096),T=n(765),A=n(5523),I=n(4479);var P=function(e){var a=e.instrumentoState,n=a.instrumento,t=a.setInstrumento,o=e.instrumentosDisponiveis;return(0,f.jsx)(k.Z,{sx:{width:"80%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},onChange:function(e){e.preventDefault(),t(o.find((function(a){return a.nome===e.target.value})))},value:n,children:(0,f.jsx)(T.Z,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:o.map((function(e){return(0,f.jsx)(A.Z,{value:e.nome,disableTypography:!0,control:(0,f.jsx)(I.Z,{}),sx:{width:"100%"},label:(0,f.jsxs)(s.Z,{sx:{width:"100% !important",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"0 !important"},children:[(0,f.jsx)(c.Z,{children:e.nome}),(0,f.jsxs)(c.Z,{children:["R$ ",e.valor]})]})},"instrumento-".concat(e.nome))}))})})},Y=n(1413),F=n(7606),M=n(3827),z=n(2904),O=n(6359);var K=function(e){var a,n=i.useState(!0),t=(0,o.Z)(n,2),r=t[0],l=t[1],u=function(){return l(!1)};return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(M.Z,{open:r,onClose:u,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,f.jsxs)(z.Z,{className:"modal",children:[(0,f.jsxs)(s.Z,{className:"modal-box",children:[(0,f.jsx)(F.Z,{className:"modal-icon",sx:{fontSize:100,color:"#29c760"}}),(0,f.jsx)(c.Z,{className:"modal-text",children:"Esse Professor j\xe1 tem uma aula marcada para esse dia e hor\xe1rio"}),(0,f.jsx)(O.Z,{onClick:u})]}),(0,f.jsxs)(s.Z,{className:"buttons",children:[(0,f.jsx)(j.Z,{variant:"contained",className:"modal-button",onClick:u,children:"Cancelar"}),(0,f.jsx)(j.Z,{variant:"contained",className:"modal-button",onClick:(a=!0,function(){console.log(a),e.filaState.setFila((0,Y.Z)((0,Y.Z)({},e.filaState),{},{fila:a})),u()}),children:"Colocar na fila"})]})]})})})},R=function(e){return m.Z.get(e,{headers:{Authorization:"Bearer ".concat(sessionStorage.TOKEN)}})},L=function(e,a){return m.Z.post(e,a,{headers:{Authorization:"Bearer ".concat(sessionStorage.TOKEN)}})},B=function(){var e=w()(new Date),a=e.minute().toString();return 1!==a.length&&(a=a[1]),!a.includes(0)&&!a.includes(5)&&a<5?e=e.add(5-a,"minute"):!a.includes(0)&&!a.includes(5)&&a>5&&(e=e.add(10-a,"minute")),e};var V=function(e){var a=e.stepsState,n=a.step,r=a.steps,u=a.setStep,h=e.instrumentoState,p=h.instrumento,S=h.setInstrumento,N=e.adicionarErro,D=(0,l.s0)(),E=(0,i.useState)(B),b=(0,o.Z)(E,2),w=b[0],C=b[1],y=(0,i.useState)([]),k=(0,o.Z)(y,2),T=k[0],A=k[1],I=(0,i.useState)([]),Y=(0,o.Z)(I,2),F=Y[0],M=Y[1],z=(0,i.useState)(!1),O=(0,o.Z)(z,2),V=O[0],W=O[1],$=(0,i.useState)(!1),Q=(0,o.Z)($,2),U=Q[0],_=Q[1],q=(0,i.useState)(!1),G=(0,o.Z)(q,2),J=G[0],X=G[1];(0,i.useEffect)((function(){J&&u(1)}),[J]);var ee=function(e){return e===r.length-2?"Finalizar":e===r.length?"Ver meus pedidos":"Continuar"}(n);return(0,i.useEffect)((function(){Promise.all([R("/aulas/ativas/".concat(e.idProfessor)),R("pedidos/usuario/".concat(e.idProfessor,"/confirmado"))]).then((function(e){var a=(0,o.Z)(e,2),n=a[0],r=a[1],s=n.data,i=r.data;console.log("Aulas:"),console.log(s),console.log("Pedidos:"),console.log(i),function(e){for(var a,n=[],t=0;t<e.length;t++)a=e[t],n.push({id:a.id,nome:a.instrumento.nome,valor:a.valorAula});A(n)}(s),function(e){for(var a,n,o,r=0;r<e.length;r++)a=e[r],(n=new Date(a.dataAula)).setMinutes(n.getMinutes()-55),(o=new Date(a.dataAula)).setHours(o.getHours()+1),M((function(e){return[].concat((0,t.Z)(e),[{inicio:n,fim:o}])}))}(i)}))}),[]),(0,f.jsxs)(d.Z,{className:"card-pedido",children:[(0,f.jsx)(x.Z,{activeStep:n,alternativeLabel:!0,children:r.map((function(e){return(0,f.jsx)(Z.Z,{children:(0,f.jsx)(g.Z,{children:e})},e)}))}),2!==n?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.Z,{className:"pedido-titulo",children:"Escolha o dia e o hor\xe1rio que voc\xea deseja ter a aula"}),(0,f.jsxs)(s.Z,{className:"pedido-form",children:[0===n&&(0,f.jsx)(H,{handleClicks:{handleClickDia:function(e){C(e)},handleClickHorario:function(e){e=(e=e.second(0).millisecond(0)).day(w.day()).month(w.month()).year(w.year()),C(e)}},diaEHoraEscolhidosState:{diaEHoraEscolhidos:w,setDiaEHoraEscolhidos:C},errorHorarioState:{erroHorario:V,setErroHorario:W},diasIndisponiveis:F,obterDataValida:B}),1===n&&(0,f.jsx)(P,{instrumentoState:{instrumento:p,setInstrumento:S},instrumentosDisponiveis:T}),3===n&&(0,f.jsx)(c.Z,{className:"pedido-texto-finalizado",children:"Aguarde o professor analisar a proposta, se for aceita poder\xe1 fazer o pagamento"})]}),(0,f.jsx)(j.Z,{className:"botao-passar-etapa",onClick:function(){if(0===n)!function(a){var t=a.format("YYYY-MM-DDTHH:mm:ss");console.log(t),m.Z.get("/pedidos/usuario/".concat(e.idProfessor),{headers:{Authorization:"Bearer ".concat(sessionStorage.TOKEN)}}).then((function(e){for(var o=e.data,r=!0,s=0;s<o.length;s++)console.log(o[s].dataAula),o[s].dataAula===t&&(r=!1,console.log("Aula j\xe1 marcada"),_(!0));if(r){var i=a.minute().toString();1!==i.length&&(i=i[1]),i.includes(0)||i.includes(5)||N("O hor\xe1rio escolhido n\xe3o est\xe1 dispon\xedvel, o hor\xe1rio foi alterado para o mais pr\xf3ximo poss\xedvel"),V||u(n+1)}})).catch((function(e){console.log(e)}))}(w);else if(1===n){if(null===p)return void N("Escolha um instrumento!");_(!1),u(n+1),L("/pedidos",{alunoId:sessionStorage.getItem("ID"),professorId:new URLSearchParams(window.location.search).get("id"),aulaId:p.id,dataAula:w.format("YYYY-MM-DD HH:mm:ss")}).then((function(){setTimeout((function(){J&&L("/pedidos/fila-espera/\n                    ".concat(sessionStorage.getItem("ID"),"?data=").concat(w.format("YYYY-MM-DD HH:mm:ss")),{}).then((function(){console.log("Fila adicionada!")})).catch((function(e){console.log(e),N("Erro ao enviar pedido!")}))}),5e3),u(3)})).catch((function(e){console.log(e),N("Erro ao enviar pedido!")}))}else 3===n?D("/pedidos"):1!==n&&u(n+1)},children:ee})]}):(0,f.jsx)(v.Z,{}),!0===U?(0,f.jsx)(K,{filaState:{fila:J,setFila:X}}):null]})},W=n(2703),$=["Escolha o dia","Escolha o instrumento","Proposta Feita"];var Q=function(){var e=(0,i.useState)(null),a=(0,o.Z)(e,2),n=a[0],c=a[1],u=(0,i.useState)(0),d=(0,o.Z)(u,2),m=d[0],h=d[1],x=(0,i.useState)([]),Z=(0,o.Z)(x,2),g=Z[0],j=Z[1],v=(0,l.s0)(),S=new URLSearchParams(window.location.search).get("id");return(0,i.useEffect)((function(){(0,W.Wi)()&&v("/login")}),[]),(0,f.jsx)(r.Z,{tela:"realizar-pedido",errosState:{erros:g,setErros:j},children:(0,f.jsxs)(s.Z,{className:"pagina-container",children:[(0,f.jsx)(p,{idProfessor:S,instrumento:n}),(0,f.jsx)(V,{stepsState:{step:m,steps:$,setStep:h},instrumentoState:{instrumento:n,setInstrumento:c},idProfessor:S,adicionarErro:function(e){return j([].concat((0,t.Z)(g),[e]))}})]})})}},2703:function(e,a,n){n.d(a,{Wi:function(){return s},Y8:function(){return i},mA:function(){return l}});var t=n(4165),o=n(5861),r=n(1243);function s(){var e=sessionStorage.TOKEN;return(null===e||""===e||e.length<186)&&(sessionStorage.TOKEN="",!0)}function i(e){var a=(e=e.split("/"))[0],n=e[1],t=e[2];return a<1||a>31?{error:!0,helperText:"Dia inv\xe1lido"}:n<1||n>12?{error:!0,helperText:"M\xeas inv\xe1lido"}:t<1900||t>(new Date).getFullYear()?{error:!0,helperText:"Ano inv\xe1lido"}:new Date(t,n-1,a)>new Date?{error:!0,helperText:"Data de Nascimento inv\xe1lida"}:{error:!1}}function l(e){return c.apply(this,arguments)}function c(){return(c=(0,o.Z)((0,t.Z)().mark((function e(a){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},e.next=3,r.Z.get("https://viacep.com.br/ws/".concat(a,"/json/")).then((function(e){n=e.data.erro?null:e.data})).catch((function(e){console.log(e)}));case 3:return console.log("Resposta:"),console.log(n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=975.db807d11.chunk.js.map